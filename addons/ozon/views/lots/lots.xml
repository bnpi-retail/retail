<odoo>
    <data>

        <!-- Form -->
        <record id="view_action_products_form" model="ir.ui.view">
            <field name="name">Лоты</field>
            <field name="model">ozon.products</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <form>

                    <div name="button_box" position="inside">
                        <button class="oe_stat_button" type="object" name="history_price">
                            <field string="История цен" name="price_history_count" widget="statinfo" />
                        </button>
                        <button class="oe_stat_button" type="object" name="get_sales">
                            <field string="История продаж" name="get_sales_count" widget="statinfo" />
                        </button>
                    </div>

                    <!-- Main info -->
                    <notebook>
                        <page id="page_lot_price_profit_main_info" string="Цена и прибыль">
                            <group>
                                <group>
                                    <field name="id_on_platform" />
                                    <field name="products" />
                                </group>
                                <group>
                                    <group>
                                        <field name="is_selling" />
                                        <field name="is_alive" />
                                    </group>
                                    <group>
                                        <field name="trading_scheme" readonly="true" />
                                        <field name="stocks_fbs" />
                                        <field name="stocks_fbo" />
                                    </group>
                                </group>
                            </group>
                            <group>
                                <group>
                                    <group string="Цена">
                                        <field name="price" />
                                        <field name="old_price"
                                            style="text-decoration:line-through;" />
                                    </group>
                                    <group string="Прибыль">
                                        <field name="profit" />
                                        <field name="profit_ideal" />
                                        <field name="profit_delta" />
                                        <field name="profitability_norm" readonly="true" />
                                    </group>
                                </group>
                                <group string="Коэффициенты">
                                    <field name="sales_per_day_last_30_days" readonly="true" />
                                    <field name="sales_per_day_last_30_days_group" readonly="true" />
                                    <field name="coef_profitability" widget="percentage"
                                        style="max-width: 58px;" readonly="true" />
                                    <field name="coef_profitability_group" readonly="true" />
                                </group>
                            </group>
                        </page>

                        <page id="page_lot_expenses_info" string="Комиссии и себестоимость">
                            <separator string="Фиксированные затраты" />
                            <notebook>
                                <page id="page_fbs_fix" string="FBS">
                                    <group>
                                        <group>
                                            <field name="fbs_fix_expenses_min">
                                                <tree>
                                                    <field name="name" />
                                                    <field name="price" />
                                                </tree>
                                            </field>
                                            <field name="total_fbs_fix_expenses_min" />
                                        </group>
                                        <group>
                                            <field name="fbs_fix_expenses_max">
                                                <tree>
                                                    <field name="name" />
                                                    <field name="price" />
                                                </tree>
                                            </field>
                                            <field name="total_fbs_fix_expenses_max" />
                                        </group>
                                    </group>
                                </page>
                                <page id="page_fbo_fix" string="FBO">
                                    <group>
                                        <group>
                                            <field name="fbo_fix_expenses_min">
                                                <tree>
                                                    <field name="name" />
                                                    <field name="price" />
                                                </tree>
                                            </field>
                                            <field name="total_fbo_fix_expenses_min" />
                                        </group>
                                        <group>
                                            <field name="fbo_fix_expenses_max">
                                                <tree>
                                                    <field name="name" />
                                                    <field name="price" />
                                                </tree>
                                            </field>
                                            <field name="total_fbo_fix_expenses_max" />
                                        </group>
                                    </group>
                                </page>
                            </notebook>

                            <separator string="Процентные затраты" />
                            <notebook>
                                <page id="page_fbs_percent" string="FBS">
                                    <group>
                                        <field name="fbs_percent_expenses">
                                            <tree>
                                                <field name="name" />
                                                <field name="discription" />
                                                <field name="price" />
                                            </tree>
                                        </field>
                                        <field name="total_fbs_percent_expenses" />
                                    </group>
                                </page>
                                <page id="page_fbo_percent" string="FBO">
                                    <group>
                                        <field name="fbo_percent_expenses">
                                            <tree>
                                                <field name="name" />
                                                <field name="discription" />
                                                <field name="price" />
                                            </tree>
                                        </field>
                                        <field name="total_fbo_percent_expenses" />
                                    </group>
                                </page>
                            </notebook>
                        </page>
                        <page id="page_lot_description_info" string="Описание">
                            <group>
                                <field name="categories" />
                                <field name="supplementary_categories">
                                    <tree>
                                        <field name="name" />
                                    </tree>
                                </field>
                            </group>

                            <group>
                                <field name="description" />
                            </group>
                            <group>
                                <field name="search_queries" widget="many2many_tags" />
                            </group>
                            <group string="Изображения">
                                <field name="imgs_html" string="Изображения" />
                            </group>
                        </page>
                        <page id="page_lot_promotion_info" string="Продвижение">
                            <group>
                                <field name="tracked_search_queries" widget="one2many_list"
                                    string="Отслеживаемые поисковые запросы по описанию">
                                    <tree>
                                        <field name="name" />
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page id="page_lot_competitors_info" string="Конкуренты">
                            <group string="Конкуренты">
                                <field name="competitors_with_price_ids" widget="one2many_list">
                                    <tree limit="10">
                                        <field name="number"/>
                                        <field name="name"/>
                                        <field name="price_with_card"/>
                                        <field name="price"/>
                                        <field name="price_without_sale"/>
                                        <field name="is_my_product"/>
                                        <field name="ad"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <!-- Tree -->
        <record id="view_action_products_tree" model="ir.ui.view">
            <field name="name">Лоты</field>
            <field name="model">ozon.products</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="products" />
                    <field name="price" />
                    <field name="is_selling" />
                    <field name="is_alive" />
                    <field name="trading_scheme" />
                    <field name="coef_profitability" />
                </tree>
            </field>
        </record>

        <!-- Actions -->
        <record model="ir.actions.act_window" id="action_products">
            <field name="name">Лоты</field>
            <field name="res_model">ozon.products</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.server" id="action_add_product_to_mass_pricing_queue">
            <field name="name">Добавить в очередь изменения цен</field>
            <field name="model_id" ref="model_ozon_products" />
            <field name="binding_model_id" ref="model_ozon_products" />
            <field name="binding_view_types">form</field>
            <field name="state">code</field>
            <field name="code">
                action = records.create_mass_pricing()
            </field>
        </record>

        <record model="ir.actions.server" id="action_draw_plot">
            <field name="name">Рассчитывать PLOT</field>
            <field name="model_id" ref="model_ozon_mass_pricing" />
            <field name="binding_model_id" ref="model_ozon_products" />
            <field name="state">code</field>
            <field name="code">
                records.draw_plot()
            </field>
        </record>

        <!-- <record model="ir.actions.act_window" id="action_products_create_mass_pricing_">
            <field name="name">Добавить в очередь на изменение цен</field>
            <field name="res_model">ozon.mass_pricing</field>
            <field name="binding_model_id" ref="model_ozon_products" />
            <field name="binding_view_types">form</field>
            <field name="target">new</field>
            <field name="view_mode">form</field>
            <field name="context">{
                "default_product": active_id,
                }</field>
        </record> -->

        <!-- Action to call profitability_norm wizard. This action calls wizard model form view -->
        <record id="wizard_action_profitability_norm" model="ir.actions.act_window">
            <field name="name">Назначить норму прибыльности</field>
            <field name="type">ir.actions.act_window</field>
            <field name="binding_model_id" ref="model_ozon_products" />
            <field name="res_model">ozon.profitability_norm.wizard</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="wizard_view_profitability_norm_form" />
            <field name="target">new</field>
        </record>

        <!-- Calculator form -->
        <record id="view_products_calculator_form" model="ir.ui.view">
            <field name="name">Калькулятор</field>
            <field name="model">ozon.products</field>
            <field name="arch" type="xml">
                <form create="false" write="false" delete="false">
                    <style>
                        <!-- header{display:none !important;}  --> footer{ display:none !important;} </style>

                    <field name="products" readonly="true" style="margin-bottom: 30px;" />
                    <button type="object" name="reset_calculator"
                        string="Сбросить" />
                    <group>
                        <group>
                            <field name="profitability_norm"
                                string="Обеспечить норму прибыльности в" />
                            <field name="pricing_strategy_id" />
                        </group>
                        <group>
                            <field name="price" />
                            <field name="profit" />
                            <field name="profit_ideal" />
                            <field name="profit_delta" />
                            <field name="coef_profitability" widget="percentage"
                                style="max-width: 58px;" readonly="true" />

                        </group>
                        <field name="total_fbs_fix_expenses_max" invisible="true" />
                        <field name="total_fbo_fix_expenses_max" invisible="true" />
                        <field name="total_fbs_percent_expenses" invisible="true" />
                        <field name="total_fbo_percent_expenses" invisible="true" />
                    </group>

                </form>
            </field>
        </record>

        <record model="ir.actions.server" id="action_product_calculator">
            <field name="name">Калькулятор</field>
            <field name="model_id" ref="model_ozon_products" />
            <field name="binding_model_id" ref="model_ozon_products" />
            <field name="binding_view_types">form</field>
            <field name="state">code</field>
            <field name="code">
                action = records.calculator()
            </field>
        </record>

        <!-- Menu -->
        <menuitem name="Лоты"
            id="menu_products"
            parent="main_menu_products"
            action="action_products"
            sequence="20" />

    </data>
</odoo>