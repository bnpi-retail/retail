<odoo>
    <data>

        <!-- Form -->
        <record id="view_categories_form" model="ir.ui.view">
            <field name="name">Основная категория</field>
            <field name="model">ozon.categories</field>
            <field name="arch" type="xml">
                <form>
                    <notebook>
                        <page string="Основная информация">
                            <group>
                                <field name="c_id" />
                                <field name="name_categories" />
                                <field name="category_manager" string="Ответственный менеджер" />
                                <field name="abc_group_last_update" readonly="1"
                                    string="Последний ABC Анализ" />
                                <field name="bcg_matrix_last_update" readonly="1"
                                    string="Последний расчет BCG Матрицы" />
                            </group>
                        </page>

                        <page string="Аналитические данные">
                            <group string="Разница между нашей ценой и ценой для покупателя"
                                attrs="{'invisible': [('is_price_difference_computed', '=', False)]}"
                            >
                                <field name="category_total_price" readonly="1" />
                                <field name="category_total_marketing_price" readonly="1" />
                                <field name="price_difference" readonly="1" widget="percentage" />
                                <field name="is_price_difference_computed" invisible="1" />
                            </group>
                            <separator string="Графические данные"/>
                            <group>
                            <group>
                                <field name="img_sale_this_year" widget="image" readonly="0"/>

                                <field name="img_data_sale_this_year" invisible="1" />
                                <field name="img_data_sale_last_year" invisible="1" />
                                <field name="img_data_analysis_data_this_year" invisible="1"/>

                                <button string="Скачать данные"
                                        type="object"
                                        class="oe_highlight"
                                        icon="fa-download"
                                        name="download_data_sale_this_year"
                                        attrs="{'invisible': [('img_data_sale_this_year', '=', False)]}"
                                />
                            </group>

                            <group>
                                <field name="img_sale_last_year" widget="image" readonly="0"/>
                                <button string="Скачать данные"
                                        type="object"
                                        class="oe_highlight"
                                        icon="fa-download"
                                        name="download_data_sale_last_year"
                                        attrs="{'invisible': [('img_data_sale_last_year', '=', False)]}"
                                />
                            </group>
                            </group>

                            <separator/>

                            <group>
                                <group>
                                    <field name="img_analysis_data_this_year" widget="image" readonly="0"/>
                                    <button string="Скачать данные"
                                            type="object"
                                            class="oe_highlight"
                                            icon="fa-download"
                                            name="download_data_analysis_data_this_year"
                                            attrs="{'invisible': [('img_data_analysis_data_this_year', '=', False)]}"
                                    />
                                </group>
                                <group>

                                </group>
                            </group>


                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <!-- Tree -->
        <record id="view_main_categories_tree" model="ir.ui.view">
            <field name="name">Основные категории</field>
            <field name="model">ozon.categories</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name_categories"/>
                    <field name="category_manager" string="Ответственный менеджер"/>
                    <field name="abc_group_last_update" readonly="1"
                           string="Последний ABC Анализ"/>
                    <field name="bcg_matrix_last_update" readonly="1"
                           string="Последний расчет BCG Матрицы"/>
                </tree>
            </field>
        </record>

        <!-- Search -->
        <record id="view_main_categories_search" model="ir.ui.view">
            <field name="name">Категории</field>
            <field name="model">ozon.categories</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name_categories" />
                </search>
            </field>
        </record>

        <!-- Action -->
        <record model="ir.actions.act_window" id="action_main_categories">
            <field name="name">Основные категории</field>
            <field name="res_model">ozon.categories</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.server" id="action_draw_graphs_for_categores">
            <field name="name">Рассчитать "Аналитические данные"</field>
            <field name="model_id" ref="model_ozon_categories" />
            <field name="binding_model_id" ref="model_ozon_categories" />
            <field name="state">code</field>
            <field name="code">
                records.action_draw_graphs_by_categories()
            </field>
        </record>

        <record model="ir.actions.server" id="action_compute_average_prices_difference">
            <field name="name">Рассчитать среднее значение разницы наших цен и цен для покупателя</field>
            <field name="model_id" ref="model_ozon_categories" />
            <field name="binding_model_id" ref="model_ozon_categories" />
            <field name="state">code</field>
            <field name="code">
                records.action_compute_average_prices_difference()
            </field>
        </record>


    </data>
</odoo>